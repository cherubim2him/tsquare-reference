<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>2. Set up Environment</title>
<link rel="stylesheet" href="styles/pos.css" type="text/css">
<link rel="stylesheet" href="styles/styles.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.70.0">
<link rel="start" href="install-overview.html" title="Installation Guide">
<link rel="up" href="install-overview.html" title="Installation Guide">
<link rel="prev" href="install-overview.html" title="Installation Guide">
<link rel="next" href="install-build.html" title="3. Build and Deploy">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div id="frame">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">2. Set up Environment</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="install-overview.html">Prev</a> </td>
<th width="60%" align="center"> </th>
<td width="20%" align="right"> <a accesskey="n" href="install-build.html">Next</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1" lang="en">
<div class="titlepage"><div><div><h2 class="title">
<a name="install-env"></a>2. Set up Environment</h2></div></div></div>

        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id5032022"></a>2.1. Verify Java Installation</h3></div></div></div>

            <p>Check to see if you have Java (version 1.4.2 or higher) installed on your system
                by running the following command (sample output from a *nix system):</p>
            <pre class="screen">
$ java -version
java version "1.5.0_06"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_06-b05)
Java HotSpot(TM) Server VM (build 1.5.0_06-b05, mixed mode)</pre>
            <p>If you're going to be building the source (i.e. if you chose the source install)
                then you'll want to make sure that you have also installed the full J2SE, and not just the JRE.</p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">JRE vs. JDK vs. J2SE vs. J2EE</h3>

                <p>If you're unfamiliar with the Java world, you may find the acronyms for
                    various Java environments a little mysterious. The JRE is simply the runtime
                    environment which allows you to run compiled Java code. The JDK (or, for version
                    1.4 of Java, the J2SDK) is the Java Developer's Kit, which includes all the
                    basic requirements for developing and building Java code. The J2SE (the
                    "Standard Edition") is simply the combination of the JDK and the JRE - this is
                    the one you want to complete the source installation.</p>
                <p>If you go to the Sun site for a download, you may also run across the J2EE
                    (the "Enterprise Edition"), or even the J2ME (the "Micro Edition"). Don't
                    trouble yourself with these, unless you know of a particular reason why you may
                    want them - neither is necessary for a Sakai installation.</p>
            </div>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id5032062"></a>2.2. Verify Java Environment Variables</h3></div></div></div>

            <p>Set the "JAVA_HOME" environment variable to point to the base directory of your
                Java installation, which will enable Tomcat to find the right Java installation.
                This may already have been set up for you by your Java installation, but it should
                be double-checked.</p>
            <p>In UNIX operating systems you typically modify a startup file like ~/.bash_login
                to set and export these shell variables. For Windows XP you would go to
                    <span class="emphasis"><em>Start -&gt; Control Panel -&gt; System -&gt; Advanced -&gt; Environment
                Variables</em></span> and then set them to point to the correct locations (samples
                below):</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows</span></td>
<td>
                        <p> Set the environment variable <span><strong class="command">JAVA_HOME</strong></span> to
                                <span><strong class="command">C:\jdk1.5.0_06</strong></span>. </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac/*nix</span></td>
<td>
                        <p>
                            <span><strong class="command">export JAVA_HOME=/usr/java/java-current</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <p>Next you'll want to append to the PATH variable the location of Java commands:</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows</span></td>
<td>
                        <p> Append the string <span><strong class="command">;C:\jdk1.5.0_06\bin</strong></span> to the end
                            of the system variable named Path. </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac</span></td>
<td>
                        <p> Not necessary. </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">*nix</span></td>
<td>
                        <p>
                            <span><strong class="command">export PATH=$PATH:$JAVA_HOME/bin/</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <p>You should test that these variables are set correctly. In both Windows XP and
                *nix operating systems you can simply start a new shell and type the 'set' command
                to see your environment variables. You may run the <span><strong class="command">java -version</strong></span>
                command once more as a final check. You can also look for the <a href="http://java.sun.com/j2se/1.5.0/install.html" target="_top">Sun Java Installation
                    Instructions</a> page at the Java web site for further details.</p>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id5032239"></a>2.3. Install Tomcat</h3></div></div></div>

            <p>Sakai 2.2.0 was QA'ed with Tomcat 5.5.17. Tomcat can be downloaded as a binary
                from <a href="http://tomcat.apache.org/download-55.cgi" target="_top">http://tomcat.apache.org/download-55.cgi</a>. The distribution you want is
                the one labeled <span class="emphasis"><em>Core</em></span>, along with the <span class="emphasis"><em>JDK 1.4
                    Compatibility Package</em></span> (even if you're using Java 1.5, some portions
                of the Sakai code will need the compatibility package).</p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Tomcat on Windows</h3>

                <p>Windows users have the option of either downloading an .exe Tomcat installer
                    (for installing Tomcat as a service) or a .zip binary. Although either may
                    serve, they are however not entirely equivalent when it comes to operational
                    details, and for brevity's sake it's recommended that you grab the .zip. Sakai
                    requires some tuning of the JVM, and the service install manages these settings
                    through the registry rather than environment variables (see Tomcat installation
                    instructions for more details). It's the latter approach that these instructions
                    assume.</p>
            </div>
            <p>Unpack the Tomcat archive at your desired location, and unpack the compatibility
                package directly on top of it. From this point forward these instructions will refer
                to the top-level Tomcat directory (e.g. apache-tomcat-5.5.17) as $CATALINA_HOME. You
                may set this as an environment variable for convenience's sake, but this is not
                required. Make sure that you have write permissions to the Tomcat files and
                directories before proceeding, or you may later run into errors during the build
                phase.</p>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id5032286"></a>2.4. Configure Tomcat</h3></div></div></div>

            <p>Sakai supports UTF-8, allowing for non-Roman characters, but this requires that
                Tomcat be configured to accept UTF-8 URLs since it ships with ISO-8859-1 as the
                default URL encoding. To change this setting, edit
                    <span><strong class="command">$CATALINA_HOME/conf/server.xml</strong></span>. Add the attribute
                    <span><strong class="command">URIEncoding="UTF-8"</strong></span> to the &lt;connector&gt; element.
                For example:</p>
            <pre class="screen">&lt;Connector port="8080" maxThreads="150" minSpareThreads="25" maxSpareThreads="75"
enableLookups="false" redirectPort="8443" acceptCount="100" debug="0"
connectionTimeout="20000" disableUploadTimeout="true" URIEncoding="UTF-8"/&gt;</pre>
            <p>If you want to run Tomcat on different ports than the defaults, this would also be
                a good time to make those changes in the server.xml file. See <a href="http://tomcat.apache.org/tomcat-5.5-doc/config/http.html" target="_top">Tomcat
                    configuration</a> documentation for more details.</p>
            <p> If you're going to run Tomcat as your sole web server (i.e. if you're not going
                to connect it to Apache) then you'll want to make a further minor change that may
                spare some confusion later. The ROOT webapp is the one served up when a request is
                made to your Tomcat's root URL, and so if you want users to be re-directed
                automatically to the Sakai application, you'll want to insert an index.html file
                into webapps/ROOT that prompts this re-direction. It should look something like: </p>
            <pre class="screen">
&lt;html&gt;
    &lt;head&gt;
        &lt;meta http-equiv="refresh" content="0;url=/portal"&gt;
    &lt;/head&gt;
    &lt;body&gt;
        redirecting to /portal ...
    &lt;/body&gt;
&lt;/html&gt;</pre>
            <p>If you don't make this change you (and your users) will need to append '/portal'
                to the URL entered to access Sakai each time. If you intend to connect Tomcat with
                Apache, you can handle this issue as a matter of Apache configuration, which is
                however outside the scope of this document.</p>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id5032343"></a>2.5. Install Maven</h3></div></div></div>

            <p>Maven is the build tool used by Sakai, and the latest stable release (currently
                1.0.2) can be downloaded from <a href="http://maven.apache.org/start/download.html" target="_top">
                    http://maven.apache.org/start/download.html</a></p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Newer versions of Maven</h3>

                <p>It's important that Maven 1.0.2 be used. There are betas for Maven 1.1 and
                    Maven 2.0 currently available, but neither will work for Sakai 2.1. Many plugins
                    have not yet been adapted for the new Maven architecture.</p>
            </div>
            <p>Choose a location for Maven, and unpack the archive there. You will have a
                top-level directory named <span><strong class="command">maven-1.0.2</strong></span>.</p>
        </div>
        <div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id5032385"></a>2.6. Configure Maven</h3></div></div></div>

            <p>To use Maven you'll need to set two more environment variables and then create a
                local repository using a script provided by Maven. Just as with the Java variables,
                    <span><strong class="command">MAVEN_HOME</strong></span> should be set, and then Maven's binary commands
                should be added to the Path:</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows</span></td>
<td>
                        <p> Create a new <span><strong class="command">MAVEN_HOME</strong></span> environment variable to
                                <span><strong class="command">C:\maven-1.0.2</strong></span> Append to the PATH variable
                                <span><strong class="command">;C:\maven-1.0.2\bin</strong></span>
                        </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac/*nix</span></td>
<td>
                        <p>
                            <span><strong class="command">export MAVEN_HOME=/usr/local/maven export
                                PATH=$PATH:$MAVEN_HOME/bin</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <p>Next you'll want to create your local repository by running the following:</p>
            <div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td>
<span class="term">Windows</span></td>
<td>
                        <p>
                            <span><strong class="command">install_repo.bat
                            %HOMEDRIVE%%HOMEPATH%\.maven\repository</strong></span>
                        </p>
                    </td>
</tr>
<tr>
<td>
<span class="term">Mac/*nix</span></td>
<td>
                        <p>
                            <span><strong class="command">install_repo.sh $HOME/.maven/repository</strong></span>
                        </p>
                    </td>
</tr>
</tbody>
</table></div>
            <p>Finally, you'll need to create a build properties file in your home directory
                which will define some basic parameters for your Sakai build. Simply create a new
                text file with the filename build.properties in your home directory, and paste in
                the following contents:</p>
            <pre class="screen">
maven.repo.remote=http://source.sakaiproject.org/maven/
maven.tomcat.home=/usr/local/tomcat/</pre>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">build.properties syntax</h3>

                <p>Maven is very sensitive to the syntax of the build.properties file. Be sure
                    not to omit the trailing slashes as shown above, and be sure to change the value
                    of <span class="emphasis"><em>maven.tomcat.home</em></span> to match the path to your Tomcat
                    installation.</p>
                <p>Further, if you are running on Windows special care is needed in identifying
                    your tomcat home. Maven wants Unix-style forward slashes, "/", and is confused
                    by Windows-style backslashes "\". If you have your tomcat located in
                        <span class="emphasis"><em>c:\tomcat</em></span>, for example, you need to identify it like
                    this:</p>
                <pre class="screen">maven.tomcat.home=c:/tomcat/</pre>
            </div>
            <p>Finally, to confirm that you can start Maven, run the command <span><strong class="command">maven
                -v</strong></span>. This should start maven and cause it to report its version. At this
                point your environment is prepared to build and deploy the Sakai source code.</p>
        </div>
    </div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="install-overview.html">Prev</a> </td>
<td width="20%" align="center"> </td>
<td width="40%" align="right"> <a accesskey="n" href="install-build.html">Next</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Installation Guide </td>
<td width="20%" align="center"><a accesskey="h" href="install-overview.html">Home</a></td>
<td width="40%" align="right" valign="top"> 3. Build and Deploy</td>
</tr>
</table>
</div>
<br clear="all"></div>
</body>
</html>
